# mybatis-plugin-shard
MyBatis 插件，实现：
- 分库：简单的分库功能，更确切的讲，是多数据源管理，可根据业务动态切换数据源。
    - 基于切面（AOP）。
- 分表功能：对于同一数据源下相同表结构的表，通过简单配置，实现分表功能。
    - 应对数据量增加迅速的业务。
    - 要求所有表在同一个数据源下（以后优化）。
    - 底层实现：基于 MyBatis 插件，拦截最终执行的 SQL 语句并且根据分表配置对 SQL 语句中的表名进行修改之后再执行。

# 动态切换数据源的三种方式
- 通过参数指定：优先级最高
- 注解
    - 方法注解：优先于类注解，如果方法有注解，不再判断类的注解。
    - 类注解：在方法没有注解的情况下，类的注解会被读取。
- dal service 配置
    - 以上两种方式均没有的情况下，会读取配置信息。
    - 事先在配置文件 db-shard.properties 中配置好 biz.service.{schema key} 对应的服务类接口，在运行过程中，通过 AOP 拦截 biz.service，从而识别应该使用哪个数据源，达到分库/多数据源动态切换的目的。

如果以上三种方式都没有找到数据源，则使用默认的数据源。

# todo
- [ ] 完善分表逻辑
- [ ] 完善文档